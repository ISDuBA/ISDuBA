<!--
 This file is Free Software under the Apache-2.0 License
 without warranty, see README.md and LICENSES/Apache-2.0.txt for details.

 SPDX-License-Identifier: Apache-2.0

 SPDX-FileCopyrightText: 2023 German Federal Office for Information Security (BSI) <https://www.bsi.bund.de>
 Software-Engineering: 2023 Intevation GmbH <https://intevation.de>
-->

<script lang="ts">
  import Collapsible from "$lib/Advisories/CSAFWebview/Collapsible.svelte";
  import KeyValue from "$lib/Advisories/CSAFWebview/KeyValue.svelte";
  import type { Vulnerability } from "$lib/pmdTypes";

  interface Props {
    vulnerability: Vulnerability;
  }
  let { vulnerability }: Props = $props();

  let vulnerabilityIds = $derived(vulnerability.ids ? vulnerability.ids : []);
</script>

<Collapsible header="IDs" level={4}>
  {#each vulnerabilityIds as vulnerabilityID}
    <KeyValue
      keys={["Systemname", "Text"]}
      values={[vulnerabilityID.system_name, vulnerabilityID.text]}
    />
  {/each}
</Collapsible>
