<!--
 This file is Free Software under the MIT License
 without warranty, see README.md and LICENSES/MIT.txt for details.

 SPDX-License-Identifier: Apache-2.0

 SPDX-FileCopyrightText: 2023 German Federal Office for Information Security (BSI) <https://www.bsi.bund.de>
 Software-Engineering: 2023 Intevation GmbH <https://intevation.de>
-->

<script lang="ts">
  import Collapsible from "$lib/Advisories/CSAFWebview/Collapsible.svelte";
  import type { Vulnerability } from "$lib/types";
  import ValueField from "$lib/Advisories/CSAFWebview/ValueField.svelte";
  export let vulnerability: Vulnerability;
  $: vulnerabilities = vulnerability.involvements ? vulnerability.involvements : [];
</script>

<Collapsible header="Involvements" level="4">
  {#each vulnerabilities as involvement}
    {#if involvement.date}
      <ValueField label="Date" value={involvement.date} />
    {/if}
    <ValueField label="Party" value={involvement.party} />
    <ValueField label="Status" value={involvement.status} />
    {#if involvement.summary}
      <ValueField label="Summary" value={involvement.summary} />
    {/if}
  {/each}
</Collapsible>
