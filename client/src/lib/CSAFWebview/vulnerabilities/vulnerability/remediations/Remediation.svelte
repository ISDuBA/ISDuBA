<!--
 This file is Free Software under the MIT License
 without warranty, see README.md and LICENSES/MIT.txt for details.

 SPDX-License-Identifier: MIT

 SPDX-FileCopyrightText: 2023 German Federal Office for Information Security (BSI) <https://www.bsi.bund.de>
 Software-Engineering: 2023 Intevation GmbH <https://intevation.de>
-->

<script lang="ts">
  import KeyValue from "$lib/CSAFWebview/KeyValue.svelte";
  import ProductStatusValueList from "../productStatus/ProductStatusValueList.svelte";
  import type { Remediation } from "$lib/types";
  import ValueField from "$lib/CSAFWebview/ValueField.svelte";
  import ValueList from "$lib/CSAFWebview/ValueList.svelte";
  export let remediation: Remediation;
  const keys: Array<String> = [];
  const values: Array<String> = [];
  if (remediation.date) {
    keys.push("Date");
    values.push(remediation.date);
  }
  if (remediation.url) {
    keys.push("URL");
    values.push(remediation.url);
  }
</script>

<p>
  <KeyValue {keys} {values} />
</p>
<ValueField label="Details" value={remediation.details} />
{#if remediation.entitlements}
  <ValueList label="Entitlements" values={remediation.entitlements} />
{/if}
{#if remediation.group_ids}
  <ValueList label="Group IDs" values={remediation.group_ids} />
{/if}
{#if remediation.product_ids}
  <ProductStatusValueList label="Product IDs" values={remediation.product_ids} />
{/if}
{#if remediation.restart_required}
  <div>
    <h6>Restart_required</h6>
    <p>{remediation.restart_required.category}</p>
    {#if remediation.restart_required.details}
      <p>{remediation.restart_required.details}</p>
    {/if}
  </div>
{/if}
