<!--
 This file is Free Software under the MIT License
 without warranty, see README.md and LICENSES/MIT.txt for details.

 SPDX-License-Identifier: MIT

 SPDX-FileCopyrightText: 2023 German Federal Office for Information Security (BSI) <https://www.bsi.bund.de>
 Software-Engineering: 2023 Intevation GmbH <https://intevation.de>
-->

<script lang="ts">
  import Collapsible from "$lib/CSAFWebview/Collapsible.svelte";
  import Threat from "./Threat.svelte";
  import type { Vulnerability } from "$lib/types";

  export let vulnerability: Vulnerability;
  $: threats = vulnerability.threats ? vulnerability.threats : [];
</script>

<Collapsible header="Threats" level="4">
  {#each threats as threat, index}
    <Threat {threat} />
    {#if vulnerability.threats && vulnerability.threats.length > 1 && index < vulnerability.threats.length - 1}
      <hr style="width:80vw;" />
    {/if}
  {/each}
</Collapsible>
