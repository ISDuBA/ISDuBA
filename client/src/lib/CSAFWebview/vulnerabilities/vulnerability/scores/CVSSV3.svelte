<!--
 This file is Free Software under the MIT License
 without warranty, see README.md and LICENSES/MIT.txt for details.

 SPDX-License-Identifier: MIT

 SPDX-FileCopyrightText: 2023 German Federal Office for Information Security (BSI) <https://www.bsi.bund.de>
 Software-Engineering: 2023 Intevation GmbH <https://intevation.de>
-->

<script lang="ts">
  import Collapsible from "$lib/CSAFWebview/Collapsible.svelte";
  import KeyValue from "$lib/CSAFWebview/KeyValue.svelte";
  export let score: any;
  const keys: Array<String> = [];
  const values: Array<String> = [];
  if (score.cvss_v3.attackComplexity) {
    keys.push("attackComplexity");
    values.push(score.cvss_v3.attackComplexity);
  }
  if (score.cvss_v3.attackVector) {
    keys.push("attackVector");
    values.push(score.cvss_v3.attackVector);
  }
  if (score.cvss_v3.availabilityImpact) {
    keys.push("availabilityImpact");
    values.push(score.cvss_v3.availabilityImpact);
  }
  if (score.cvss_v3.availabilityRequirement) {
    keys.push("availabilityRequirement");
    values.push(score.cvss_v3.availabilityRequirement);
  }
  if (score.cvss_v3.baseScore) {
    keys.push("baseScore");
    values.push(score.cvss_v3.baseScore);
  }
  if (score.cvss_v3.baseSeverity) {
    keys.push("baseSeverity");
    values.push(score.cvss_v3.baseSeverity);
  }
  if (score.cvss_v3.confidentialityImpact) {
    keys.push("confidentialityImpact");
    values.push(score.cvss_v3.confidentialityImpact);
  }
  if (score.cvss_v3.confidentialityRequirement) {
    keys.push("confidentialityRequirement");
    values.push(score.cvss_v3.confidentialityRequirement);
  }
  if (score.cvss_v3.environmentalScore) {
    keys.push("environmentalScore");
    values.push(score.cvss_v3.environmentalScore);
  }
  if (score.cvss_v3.environmentalSeverity) {
    keys.push("environmentalSeverity");
    values.push(score.cvss_v3.environmentalSeverity);
  }
  if (score.cvss_v3.exploitCodeMaturity) {
    keys.push("exploitCodeMaturity");
    values.push(score.cvss_v3.exploitCodeMaturity);
  }
  if (score.cvss_v3.integrityImpact) {
    keys.push("integrityImpact");
    values.push(score.cvss_v3.integrityImpact);
  }
  if (score.cvss_v3.integrityRequirement) {
    keys.push("integrityRequirement");
    values.push(score.cvss_v3.integrityRequirement);
  }
  if (score.cvss_v3.modifiedAttackComplexity) {
    keys.push("modifiedAttackComplexity");
    values.push(score.cvss_v3.modifiedAttackComplexity);
  }
  if (score.cvss_v3.modifiedAttackVector) {
    keys.push("modifiedAttackVector");
    values.push(score.cvss_v3.modifiedAttackVector);
  }
  if (score.cvss_v3.modifiedAvailabilityImpact) {
    keys.push("modifiedAvailabilityImpact");
    values.push(score.cvss_v3.modifiedAvailabilityImpact);
  }
  if (score.cvss_v3.modifiedConfidentialityImpact) {
    keys.push("modifiedConfidentialityImpact");
    values.push(score.cvss_v3.modifiedConfidentialityImpact);
  }
  if (score.cvss_v3.modifiedIntegrityImpact) {
    keys.push("modifiedIntegrityImpact");
    values.push(score.cvss_v3.modifiedIntegrityImpact);
  }
  if (score.cvss_v3.modifiedPrivilegesRequired) {
    keys.push("modifiedPrivilegesRequired");
    values.push(score.cvss_v3.modifiedPrivilegesRequired);
  }
  if (score.cvss_v3.modifiedScope) {
    keys.push("modifiedScope");
    values.push(score.cvss_v3.modifiedScope);
  }
  if (score.cvss_v3.modifiedUserInteraction) {
    keys.push("modifiedUserInteraction");
    values.push(score.cvss_v3.modifiedUserInteraction);
  }
  if (score.cvss_v3.privilegesRequired) {
    keys.push("privilegesRequired");
    values.push(score.cvss_v3.privilegesRequired);
  }
  if (score.cvss_v3.remediationLevel) {
    keys.push("remediationLevel");
    values.push(score.cvss_v3.remediationLevel);
  }
  if (score.cvss_v3.reportConfidence) {
    keys.push("reportConfidence");
    values.push(score.cvss_v3.reportConfidence);
  }
  if (score.cvss_v3.scope) {
    keys.push("scope");
    values.push(score.cvss_v3.scope);
  }
  if (score.cvss_v3.temporalScore) {
    keys.push("temporalScore");
    values.push(score.cvss_v3.temporalScore);
  }
  if (score.cvss_v3.temporalSeverity) {
    keys.push("temporalSeverity");
    values.push(score.cvss_v3.temporalSeverity);
  }
  if (score.cvss_v3.userInteraction) {
    keys.push("userInteraction");
    values.push(score.cvss_v3.userInteraction);
  }
  if (score.cvss_v3.vectorString) {
    keys.push("vectorString");
    values.push(score.cvss_v3.vectorString);
  }
  if (score.cvss_v3.version) {
    keys.push("version");
    values.push(score.cvss_v3.version);
  }
</script>

<Collapsible header="CVSS V{score.cvss_v3.version}" level="5">
  <KeyValue {keys} {values} />
</Collapsible>
