<!--
 This file is Free Software under the MIT License
 without warranty, see README.md and LICENSES/MIT.txt for details.

 SPDX-License-Identifier: MIT

 SPDX-FileCopyrightText: 2023 German Federal Office for Information Security (BSI) <https://www.bsi.bund.de>
 Software-Engineering: 2023 Intevation GmbH <https://intevation.de>
-->

<script lang="ts">
  import Collapsible from "$lib/CSAFWebview/Collapsible.svelte";
  import KeyValue from "$lib/CSAFWebview/KeyValue.svelte";
  export let score: any;
  const keys: Array<String> = [];
  const values: Array<String> = [];
  if (score.cvss_v2.accessComplexity) {
    keys.push("accessComplexity");
    values.push(score.cvss_v2.accessComplexity);
  }
  if (score.cvss_v2.accessVector) {
    keys.push("accessVector");
    values.push(score.cvss_v2.accessVector);
  }
  if (score.cvss_v2.authentication) {
    keys.push("authentication");
    values.push(score.cvss_v2.authentication);
  }
  if (score.cvss_v2.availabilityImpact) {
    keys.push("availabilityImpact");
    values.push(score.cvss_v2.availabilityImpact);
  }
  if (score.cvss_v2.availabilityRequirement) {
    keys.push("availabilityRequirement");
    values.push(score.cvss_v2.availabilityRequirement);
  }
  if (score.cvss_v2.baseScore) {
    keys.push("baseScore");
    values.push(score.cvss_v2.baseScore);
  }
  if (score.cvss_v2.collateralDamagePotential) {
    keys.push("collateralDamagePotential");
    values.push(score.cvss_v2.collateralDamagePotential);
  }
  if (score.cvss_v2.confidentialityImpact) {
    keys.push("confidentialityImpact");
    values.push(score.cvss_v2.confidentialityImpact);
  }
  if (score.cvss_v2.confidentialityRequirement) {
    keys.push("confidentialityRequirement");
    values.push(score.cvss_v2.confidentialityRequirement);
  }
  if (score.cvss_v2.environmentalScore) {
    keys.push("environmentalScore");
    values.push(score.cvss_v2.environmentalScore);
  }
  if (score.cvss_v2.exploitability) {
    keys.push("exploitability");
    values.push(score.cvss_v2.exploitability);
  }
  if (score.cvss_v2.integrityImpact) {
    keys.push("integrityImpact");
    values.push(score.cvss_v2.integrityImpact);
  }
  if (score.cvss_v2.integrityRequirement) {
    keys.push("integrityRequirement");
    values.push(score.cvss_v2.integrityRequirement);
  }
  if (score.cvss_v2.remediationLevel) {
    keys.push("remediationLevel");
    values.push(score.cvss_v2.remediationLevel);
  }
  if (score.cvss_v2.reportConfidence) {
    keys.push("reportConfidence");
    values.push(score.cvss_v2.reportConfidence);
  }
  if (score.cvss_v2.targetDistribution) {
    keys.push("targetDistribution");
    values.push(score.cvss_v2.targetDistribution);
  }
  if (score.cvss_v2.temporalScore) {
    keys.push("temporalScore");
    values.push(score.cvss_v2.temporalScore);
  }
  if (score.cvss_v2.vectorString) {
    keys.push("vectorString");
    values.push(score.cvss_v2.vectorString);
  }
  if (score.cvss_v2.version) {
    keys.push("version");
    values.push(score.cvss_v2.version);
  }
</script>

<Collapsible header="CVSS V2" level="5">
  <KeyValue {keys} {values} />
</Collapsible>
